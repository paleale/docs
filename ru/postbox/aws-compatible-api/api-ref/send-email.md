# Метод SendEmail

Отправляет электронное письмо с [адреса](../../concepts/glossary.md#adress) в каталоге. Нужный каталог определяется по сервисному аккаунту, от имени которого выполняется запрос.

Альтернативный способ отправки почты — с помощью [протокола SMTP](../../quickstart.md#smtp).

## Запрос {#request}

```http
POST /v2/email/outbound-emails HTTP/2
```

### Заголовки запроса {#request-headers}

{% include [api-request-headers](../../../_includes/postbox/api-request-headers.md) %}

### Тело запроса {#request-body}

```json
{
  "FromEmailAddress": "<адрес_отправителя>",
  "FromEmailAddressIdentityArn": "<параметр_для_совместимости>",
  "Destination": {
    "ToAddresses": [
      "<адрес_получателя>"
    ],
    "CcAddresses": [
      "<адрес_получателя_копии>"
    ],
    "BccAddresses": [
      "<адрес_получателя_скрытой_копии>"
    ]
  },
  "Content": {
    "Simple": {
      "Subject": {
        "Data": "<текст_темы>",
        "Charset": "<кодировка>"
      },
      "Headers": [
        {
          "Name": "<заголовок>",
          "Value": "<значение>"
        }
      ],
      "Body": {
        "Text": {
          "Data": "<текст_письма>",
          "Charset": "<кодировка>"
        },
        "Html": {
          "Data": "<текст_письма>",
          "Charset": "<кодировка>"
        }
      }
    },
    "Template": {
      "Headers": [
        {
          "Name": "<заголовок>",
          "Value": "<значение>"
        }
      ],
      "TemplateContent": {
        "Html": "<шаблон_HTML>",
        "Subject": "<шаблон_темы>",
        "Text": "<шаблон_текста>"
      },
      "TemplateData": "<данные_для_подстановки_в_шаблоны>"
    },
    "Raw": {
      "Data": "<все_содержимое_письма>"
    }
  }
}
```

#|
|| **Параметр** | **Описание** ||
|| `FromEmailAddress` | **Тип**: string.

Адрес, с которого отправляется письмо. Он должен быть верифицирован. ||
|| `FromEmailAddressIdentityArn` | **Тип**: string.

Используется только для совместимости с AWS. ||
|| `Destination` | **Тип**: object.

Объект, который содержит адреса для доставки письма. 

* `ToAddresses` — адреса, на которые отправляется письмо. Тип: array. 
* `CcAddresses` — адреса, на которые отправляется копия письма. Тип: array.
* `BccAddresses` — адреса, на которые отправляется скрытая копия письма. Тип: array. ||
|| `Simple` | **Тип**: object.

Простой тип. Нельзя использовать вместе с `Raw` или `Template`. Подходит, если нужно отправить письмо без дополнительных настроек. Такое письмо состоит из темы и содержимого. Тип: object. ||
|| `Subject` | **Тип**: object.

Описывает тему:
  * `Data` — текст темы. Тип: string.
  * `Charset` — кодировка. Тип: string. Возможные значения: `UTF-8`. ||
|| `Headers` | **Тип**: array.
  * `Name` — имя заголовка. Тип: string.
  * `Value` — значение заголовка. Тип: string. 

`Name` не может быть одним из ограниченных заголовков: `BCC`, `CC`, `Content-Disposition`, `Content-Type`, `Date`, 
`From`, `Message-ID`, `MIME-Version`, `Reply-To`, `Return-Path`, `Subject`, `To`.||
|| `Body` | **Тип**: object.

Описывает содержимое:
  * `Text` — объект, отвечающий за отображение письма в почтовых клиентах, которые не поддерживают HTML. Тип: object.
      * `Data` — текст письма. Тип: string.
      * `Charset` — кодировка. Тип: string. Возможные значения: `UTF-8`.
  * `Html` — объект, отвечающий за отображение письма в почтовых клиентах, которые поддерживают HTML. Тип: object.
      * `Data` — текст письма. Тип: string.
      * `Charset` — кодировка. Тип: string. Возможные значения: `UTF-8`. ||
|| `Template` | **Тип**: object.

Шаблонный тип. Нельзя использовать вместе с `Simple` или `Raw`. Подходит, если нужно отправить письмо на основе шаблона. Поддерживаются только шаблоны, передаваемые в запросе.||
|| `TemplateContent` | **Тип**: object.

Содержит шаблон письма:
  * `Html` — шаблон HTML. Тип: string.
  * `Subject` — шаблон темы. Тип: string.
  * `Text` — шаблон текста. Тип: string. ||
|| `TemplateData` | **Тип**: string.

Данные, которые используются для заполнения шаблона. JSON-объект, сериализованный в строку. ||
|| `Raw` | **Тип**: object.

Необработанный тип. Нельзя использовать вместе с `Simple` или `Template`. Подходит, если нужно дополнительно настроить содержимое письма. К такому типу предъявляются требования:
  * Письмо должно состоять из заголовка и содержимого, разделенных пустой строкой.
  * В письме должны присутствовать все обязательные поля заголовков.
  * Все фрагменты MIME-письма должны быть корректно отформатированы.
  * Вложения должны быть в формате, который поддерживается сервисом {{ postbox-name }}.
  * В письме должна использоваться кодировка `Base64`.
  * Если в письме есть содержимое, которое выходит за пределы семиразрядного диапазона символов ASCII, его нужно закодировать, чтобы оно корректно отображалось в почтовом клиенте получателя.
  * Максимальная длина строки в письме — 1000 символов.

Письмо целиком размещается в параметре `Data`. Тип: string. ||
|#

## Ответы {#responses}

### 200 OK {#200}

```json
{
  "MessageId": "<идентификатор_письма>"
}
```

#|
|| **Параметр** | **Описание** ||
|| `MessageId` | **Тип**: string.

Уникальный идентификатор письма. ||
|#

### Ошибки {#errors}

{% include [api-errors](../../../_includes/postbox/api-errors.md) %}

Возможные ошибки:

#|
|| **Код ошибки** | **Описание** ||
|| `400 BadRequestException` | В запросе неправильно указаны заголовки или параметры. ||
|| `400 AccountSuspendedException` | Для этого сервисного аккаунта возможность отправлять почту ограничена навсегда. ||
|| `400 SendingPausedException` | Для этого сервисного аккаунта возможность отправлять почту временно ограничена. ||
|| `400 MessageRejected` | Письмо содержит некорректные данные. ||
|| `400 MailFromDomainNotVerifiedException` | Адрес, с которого отправляется письмо, не верифицирован. ||
|| `404 NotFoundException` | Запрошенный ресурс не найден. ||
|| `429 TooManyRequestsException` | При вызове запроса превышена [квота](../../concepts/limits.md#postbox-quotas). ||
|| `429 LimitExceededException` | При вызове запроса превышен [лимит](../../concepts/limits.md). ||
|#

## См. также {#see-also}

* [Как пользоваться Amazon S3 API для работы с {{ postbox-name }}](../index.md)
* [Аутентификация в API {{ postbox-full-name }}](../../api-ref/authentication.md)
* [Шаблонизация письма в {{ postbox-full-name }}](../../operations/send-templated-email.md)